<!doctype html>
<html>
	<head>
		<script src="http://cdn.alloyui.com/2.0.0/aui/aui-min.js"></script>
		<link href="http://cdn.alloyui.com/2.0.0/aui-css/css/bootstrap.min.css" rel="stylesheet"></link>
		<script src="file.json" name="obj"></script>
	</head>

	<body>
		<p>This page requires Javascript to be viewed correctly.</p>
		<div>
			<div id="pagination" class="pagination pagination-centered">
				<ul class="pagination-content">
					<li><a href="#">Prev</a></li>

					<li><a href="#">Next</a></li>
				</ul>
			</div>
			<div id="todos" class="content">

			</div>
		</div>
	</body>

	<script>
	"use strict";
	YUI().use(
		'aui-node',
		'aui-pagination',
		'aui-button',
		'aui-sortable-list',
		function(Y) {
			var notice = Y.one('body p');
			notice.setStyle('display','none');

			// Populate content from file.json
			for (var i = 1; obj.questions[i]; i++) {
				var startdiv = Y.one('#todos');
				var adddiv = Y.Node.create('<div />');
				var addh3 = Y.Node.create('<h3 />');
				addh3.setHTML(obj.questions[i].title);
				adddiv.set('id','page'+i);
				adddiv.setStyle('display','none');
				adddiv.setHTML(addh3);
				startdiv.appendChild(adddiv);

				if (obj.questions[i].type === 'rearrangeList') {
					var startul = Y.Node.create('<ul />');
					var count = null;
					for (var j = 0; obj.questions[i].data[j]; j++) {
						var count = count + (j+1) +',';
						var addli = Y.Node.create('<li />');
						addli.set('id',j+1);
						addli.setHTML(obj.questions[i].data[j]);
						startul.appendChild(addli);
					}
					adddiv.appendChild(startul);
					var btn = Y.Node.create('<input />');
					btn.set('id', obj.questions[i].key);
					btn.setAttribute('class','btn');
					btn.set('type','submit');
					btn.set('value','Check!');
					adddiv.appendChild(btn);
					var dnd = startul.ancestor('div');
					dnd.setAttribute('class','dnd');
				}
				if (obj.questions[i].type === 'trueFalse') {
					var startol = Y.Node.create('<ol />');
					var count = null;
					for (var j = 0; obj.questions[i].data[j]; j++) {
						var count = count + (j+1) +',';
						var addli = Y.Node.create('<li />');
						addli.setHTML(obj.questions[i].data[j]);
						var btn = Y.Node.create('<input />');
						btn.set('name',j+1);
						btn.setAttribute('class','btn ');
						btn.set('value',obj.questions[i].data[j]);
						btn.set('type','button');
						addli.appendChild(btn);
						startol.appendChild(addli);
					}
					adddiv.appendChild(startol);
					var tof = startol.ancestor('div');
					tof.setAttribute('class','tof');
				}
				if (obj.questions[i].type === 'rearrangeBlock') {

				}
			}

			//Pagination
			var gen = Y.all('.content > div');
			var contentcount = null;
			contentcount = gen.getDOMNodes().length;
			var startgen = Y.one('.pagination-content li');

			for (var i = contentcount; i > 0; i--) {
				var p = Y.Node.create('<li />');
				var q = Y.Node.create('<a />');
				q.set('href', '#');
				q.setHTML(Number(i));
				p.setHTML(q);
				startgen.placeAfter(p);
			}

			var pages = Y.all('.content div');

			new Y.Pagination(
				{
					boundingBox: '#pagination',
					circular: false,
					contentBox: '#pagination .pagination-content',
					on: {
						changeRequest: function(event) {
							var instance = this,
							state = event.state,
							lastState = event.lastState;

							if (lastState) {
								pages.item(lastState.page - 1).setStyle('display', 'none');
							}
							pages.item(state.page - 1).setStyle('display', 'block');
						}
					},
					page: 1
				}
			).render();

			//Make lists sortable
			new Y.SortableList(
				{
					dropCondition: function(event) {
						return true;
					},
					dropOn: '.content',
					nodes: '.content .dnd li'
				}
			);

			//Make T/F boxes radio style
			new Y.ButtonGroup(
				{
					boundingBox: '.tof',
					contentBox: 'li',
					type: 'radio'
				}
				).render();

			//List order checking
			var node = Y.all('.dnd .btn');
			node.on(
				'click',
				function(e) {
					var cat = e.currentTarget
					var check = cat.getAttribute('id');
					var lis = cat.ancestor('div');
					lis = lis.getElementsByTagName('li')
					var seven = lis.getAttribute('id').toString();
					console.log(seven);//for test purposes
					console.log(check);

					if (check == seven) {
						lis.setStyles(
							{
								backgroundColor: 'lightBlue',
								color: 'green'
							}
						);
					}

					else {
						lis.setStyles(
							{
								backgroundColor: 'lightYellow',
								color: 'red'
							}
						);
					}
				}
			);
		}
	);
	</script>
</html>